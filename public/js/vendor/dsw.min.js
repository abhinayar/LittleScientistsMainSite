!function e(t,n,r){function a(o,s){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!s&&c)return c(o,!0);if(i)return i(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var d=n[o]={exports:{}};t[o][0].call(d.exports,function(e){var n=t[o][1][e];return a(n||e)},d,d.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){var n=void 0,r=Number.MAX_SAFE_INTEGER,a=void 0;return t.forEach(function(t){var i=new RegExp(t.rx),o=e.match(i);o&&o.length<r&&(n=t,r=o.length,a=o)}),!!n&&{rule:n,matching:a}}},{}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=o(e("./indexeddb-manager.js")),a=o(e("./utils.js")),i=o(e("./logger.js"));function o(e){return e&&e.__esModule?e:{default:e}}var s="defaultDSWCached",c="cacheCreatedTime",u=null,d=void 0,l=void 0;var f={setup:function(e,t,n){d=e,l=n,u=t.dswVersion||"1",r.default.setup(f),r.default.create({version:1,name:c,key:"url"})},registeredCaches:[],createDB:function(e){return r.default.create(e)},deleteUnusedCaches:function(e){if(!e)return caches.keys().then(function(e){return f.registeredCaches,Promise.all(e.map(function(e){if(f.registeredCaches.indexOf(e)<0)return caches.delete(e)}))})},clear:function(e){return"window"in self?window.DSW.sendMessage({clearEverythingUp:!0},!0):caches.keys().then(function(e){var t=e.map(function(e){return caches.delete(e)});return t.push(r.default.clear()),Promise.all(t)})},mountCacheId:function(e){if("string"==typeof e)return e;var t=!!e&&e.action.cache;return t?(t.name||s)+"::"+(t.version||u):s+"::"+u},register:function(e){f.registeredCaches.push(f.mountCacheId(e))},addAll:function(e){return new Promise(function(t,n){Array.isArray(e)&&(e={files:e});var r=[];e.files.map(function(t){r.push(f.add(t,null,null,{action:{fetch:t,cache:{name:e.name,version:e.version||1,expires:e.expires||!1}}}))}),Promise.all(r).then(t).catch(n)})},put:function(e,t,n){return f.add(t,"string"==typeof e?e:f.mountCacheId(e),n,e)},add:function(e,t,n,r){return t=t||f.mountCacheId(r),new Promise(function(o,s){function c(n){200==n.status||"opaque"==n.type?caches.open(t).then(function(s){var c="opaque"==n.type?{mode:"no-cors"}:{};0!==(e.url||e).indexOf("http")&&(e=a.default.fixURL(e.url||e)),"POST"!=(e=a.default.createRequest(e,c)).method&&function(){var a={};a=r&&r.action&&r.action.cache?r.action.cache:{name:t,version:t.split("::")[1]};var o=void 0;n.bodyUsed?s.add(e).then(function(t){d.traceStep(e,"Added to cache",{cacheData:a})}).catch(function(e){i.default.error("Could not save into cache",e)}):(o=n.clone(),d.traceStep(e,"Added to cache",{cacheData:a}),s.put(e,o))}(),o(n),r&&r.action&&r.action.cache&&r.action.cache.expires&&f.setExpiringTime(e,r||t,r.action.cache.expires)}).catch(function(e){i.default.error("Could not save into cache",e),o(n)}):s(n)}n?c(n):fetch(l(null,e)).then(c).catch(function(t){d.traceStep(e,"Fetch failed"),i.default.error("[ DSW ] :: Failed fetching "+(e.url||e),t),s(n)})})},setExpiringTime:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;"string"==typeof n&&(n=function(e,t){var n=t||-1;if("string"==typeof n){var r={s:1,m:60,h:3600,d:86400,w:604800,M:2592e3,Y:31449600},a=n.slice(-1),o=n.slice(0,-1);r[a]?n=o*r[a]:(i.default.warn("Invalid duration "+n,e),n=-1)}return n>=0?1e3*parseInt(n,10):0}(t,n)),r.default.addOrUpdate({url:e.url||e,dateAdded:(new Date).getTime(),expiresAt:n},c)},hasExpired:function(e){return new Promise(function(t,n){r.default.find(c,"url",e.url||e).then(function(e){e&&(new Date).getTime()>e.dateAdded+e.expiresAt?t(!0):t(!1)}).catch(function(e){t(!1)})})},get:function(e,t,n,o,s){var c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],u=Object.keys(e.action)[0],h=t.url||t,p=new URL(h).pathname;!1===e.action.cache||"/"!=p&&!p.match(/^\/index\.([a-z0-9]+)/i)||(e.action.cache=e.action.cache||{});var g=e.options||{};g.headers=g.headers||new Headers,u="idb"==(u=u.toLowerCase())?"indexeddb":u;var v=void 0,m=null;switch(v=e.action.cache&&e.action.cache.expires?f.hasExpired(t):Promise.resolve(),u){case"bypass":if("request"==e.action[u]){var S=function(e){return e.status>=200&&e.status<300?(d.traceStep(n.request,"Request bypassed"),e):(d.traceStep(n.request,"Bypassed request failed and was ignored"),new Response(""))};return fetch(l(null,n.request)).then(S).catch(S)}d.traceStep(n.request,"Bypassed request"),u="output",e.action[u]="";case"output":return d.traceStep(n.request,"Responding with string output",{output:(e.action[u]+"").substring(0,180)}),new Response(a.default.applyMatch(o,e.action[u]));case"indexeddb":return new Promise(function(a,i){function s(i){if(!i||200!=i.status)return h=t.url,p=new URL(h).pathname,d.traceStep(n.request,"Fetch failed",{url:t.url,status:i.status,statusText:i.statusText}),d.treatBadPage(i,p,n);var o=function(e){e?d.traceStep(n.request,"Could not save response into IndexedDB",{err:e}):d.traceStep(n.request,"Response object saved into IndexedDB"),a(i)};r.default.save(e.name,i.clone(),t,e).then(o).catch(o)}r.default.get(e.name,t).then(function(r){return r?(d.traceStep(n.request,"Found stored in IndexedDB"),s(r)):(d.traceStep(n.request,"Will fetch",{url:t.url,method:t.method}),l(e,t,n,o).then(s).catch(s))})});case"redirect":case"fetch":t=d.createRedirect(e.action.fetch||e.action.redirect,n,o),h=t.url,p=new URL(h).pathname;case"cache":return m=n.request.cachedFrom?n.request.cachedFrom:null,e.action.cache&&f.mountCacheId(e),v.then(function(r){var h=void 0;return r&&!s?(d.traceStep(n.request,"Cache was expired"),h=Promise.resolve()):h=caches.match(m||t),h.then(function(s){if(s&&200!=s.status)return d.traceStep(n.request,"Not found in cache",{url:t.url,status:s.status,statusText:s.statusText}),r?(d.traceStep(n.request,"Forcing "+(r?"expired ":"")+"from cache"),f.get(e,t,n,o,!0)):(c&&(d.rules[s.status]||[]).some(function(r,a){if(p.match(r.rx)&&(r.action.fetch||r.action.redirect))return d.traceStep(n.request,"Found fallback for failure",{rule:r,url:t.url}),s=l(e,t,n,o),!0}),s);if(s)return t.url==n.request.url?(d.traceStep(n.request,"Result found in cache",{url:n.request.url,cacheSource:n.request.cachedFrom||n.request.url}),s):(d.traceStep(n.request,"Redirecting",{from:n.request.url,to:t.url},!1,{url:t.url,id:t.requestId,steps:t.traceSteps,rule:e}),Response.redirect(t.url,302));if("redirect"==u)return d.traceStep(n.request,"Must redirect",{from:n.request.url,to:t.url},!1,{url:t.url,id:t.requestId,steps:t.traceSteps,rule:e}),Response.redirect(t.url,302);var h=function(s){return"opaque"==s.type?!1!==e.action.cache?(d.traceStep(n.request,"Added to cache (opaque)",{url:t.url}),f.add(a.default.createRequest(t,{mode:t.mode||"no-cors"}),f.mountCacheId(e),s,e)):s:(s.status||(s.status=404),200==s.status?(d.traceStep(n.request,"Received result OK (200)",{url:t.url}),!1!==e.action.cache?(d.traceStep(n.request,"Saving into cache",{url:t.url}),f.add(t,f.mountCacheId(e),s,e)):s):(d.traceStep(t,"Failed fetching",{url:t.url}),r?(i.default.warn("Cache for ",t.url||t,"had expired, but the updated version could not be retrieved from the network!\n","Delivering the outdated cached data"),d.traceStep(n.request,"Using expired cache",{note:"Failed fetching, loading from cache even though it was expired"}),f.get(e,t,n,o,!0)):d.treatBadPage(s,p,n)))};return c?(d.traceStep(n.request,"Will fetch",{url:t.url,method:t.method}),l(e,t,n,o).then(h).catch(h)):void 0})});default:return n}}};n.default=f},{"./indexeddb-manager.js":4,"./logger.js":5,"./utils.js":8}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,a=e("./utils.js"),i=(r=a)&&r.__esModule?r:{default:r};var o=location.origin;n.default=function(e,t,n,r){var a=e?e.action.fetch||e.action.redirect:"";"string"==typeof t&&(t=i.default.fixURL(t),t=location.origin+t),a?(a=i.default.fixURL(a),a=location.origin+a):a=t.url||t;var s=void 0;try{s=new URL(a).origin==o}catch(e){throw new Error('The URL "'+a+'" is not valid and could not be parsed.')}if(a=i.default.applyMatch(r,a),t&&!e)return function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=t.mode;a&&"navigate"!=a||(a=r?"cors":"no-cors");var i=new Request(e,{method:t.method||"GET",headers:t.headers||{},mode:a,cache:"default",redirect:"manual"});return t.body&&(i.body=t.body),i.requestId=(n?n.request:t).requestId,i.traceSteps=(n?n.request:t).traceSteps,i}(a,t,n,s);var c=Object.keys(e.action)[0],u=e.options||{};u.headers=u.headers||new Headers,!1===e.action.cache&&(u.headers.append("pragma","no-cache"),u.headers.append("cache-control","no-store,no-cache"),a=a+(a.indexOf("?")>0?"&":"?")+(new Date).getTime());var d={method:u.method||t.method,headers:u||t.headers,mode:"redirect"==c?t.mode||"same-origin":"cors",redirect:"redirect"==c?"manual":t.redirect};return s||(d.mode=t.mode||"no-cors"),(t=new Request(a||t.url,d)).requestId=(n?n.request:t).requestId,t.traceSteps=(n?n.request:t).traceSteps,"redirect"==c?Response.redirect(t.url,302):fetch(t,u)}},{"./utils.js":8}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,a=e("./logger.js"),i=(r=a)&&r.__esModule?r:{default:r};var o,s={};function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"readwrite",n=s[e];return!!n&&n.transaction(e,t).objectStore(e)}var u={setup:function(e){o=e},clear:function(){var e=[],t=function(t){e.push(new Promise(function(e,n){var r=indexedDB.deleteDatabase(t);r.onsuccess=function(){e()},r.onerror=function(e){n(),i.default.error("Could not drop indexedDB database\n",e||this.error)},r.onblocked=function(e){n(),i.default.error("Could not drop indexedDB database, it was locked\n",e||this.error)}}))};for(var n in s)t(n);return Promise.all([].concat(e))},create:function(e){return new Promise(function(t,n){var r=indexedDB.open(e.name||"defaultDSWDB",parseInt(e.version,10)||void 0);function a(t,n,r){t.onversionchange=function(e){t.close()},s[n]||(s[n]=t),r(e)}r.onerror=function(t){n("Could not open the database (indexedDB) for "+e.name)},r.onupgradeneeded=function(n){var r,i=n.target.result,o={};e.key&&(o.keyPath=e.key),e.key&&!e.autoIncrement||(o.autoIncrement=!0),e.version?o.version=e.version:o.version=1,n.oldVersion&&n.oldVersion<o.version?i.deleteObjectStore(e.name):0===n.oldVersion&&(r=i.createObjectStore(e.name,o),e.indexes&&e.indexes.forEach(function(e){"string"==typeof e?r.createIndex(e,e,{}):r.createIndex(e.name,e.path||e.name,e.options)}),r.createIndex(e.key,e.key,{unique:!0})),a(i,e.name,t)},r.onsuccess=function(n){a(n.target.result,e.name,t)}})},get:function(e,t){return new Promise(function(n,r){caches.match(t).then(function(t){t?t.json().then(function(t){var r=c(e),a=!!r&&r.index(t.key),i=!!a&&a.get(t.value);i?(i.onsuccess=function(e){n(new Response(JSON.stringify(e.target.result),{headers:{"Content-Type":"application/json"}}))},i.onerror=function(e){n()}):n()}):n()})})},find:function(e,t,n){return new Promise(function(r,a){var i=c(e);if(i){var o=i.index(t).get(n);o.onsuccess=function(e){r(e.target.result)},o.onerror=function(e){a()}}else r()})},addOrUpdate:function(e,t){return new Promise(function(n,r){var a=c(t);if(a){var i=a.put(e);i.onsuccess=function(){n(e)},i.onerror=function(t){n(e)}}else n({})})},save:function(e,t,n,r){var a=this;return new Promise(function(s,u){t.json().then(function(t){var i=c(e),d=void 0;i?((d=i.put(t)).onsuccess=function(){var e={},a=r.action.indexedDB.key||"id";e.key=a,e.value=t[a],o.put("indexeddb-id-request",n,new Response(JSON.stringify(e),{headers:{"Content-Type":"application/json"}})),s()},d.onerror=function(e){u("Failed saving to the indexedDB!\n"+this.error)}):u("Failed saving into indexedDB...\n"+a.error)}).catch(function(e){i.default.error("Failed saving into indexedDB!\n",e.message||a.error,e),u("Failed saving into indexedDB:\n"+a.error)})})}};n.default=u},{"./logger.js":5}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="[  LG  ] :: ",a="[ INFO ] :: ",i="[ WARN ] :: ",o="[ FAIL ] :: ",s="[ STEP ] :: ",c={info:function(){var e=[].slice.call(arguments);e.unshift("color: blue"),e.unshift("%c "+a),console.info.apply(console,e)},log:function(){var e=[].slice.call(arguments);e.unshift("color: gray"),e.unshift("%c "+r),console.log.apply(console,e)},warn:function(){var e=[].slice.call(arguments);e.unshift("font-weight: bold; color: yellow; text-shadow: 0 0 1px black;"),e.unshift("%c "+i),console.warn.apply(console,e)},error:function(){var e=[].slice.call(arguments);e.unshift("font-weight: bold; color: red"),e.unshift("%c "+o),console.error.apply(console,e)},track:function(){var e=[].slice.call(arguments);e.unshift("font-weight: bold"),e.unshift("%c "+s),console.debug.apply(console,e)}};n.default=c},{}],6:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=u(e("./logger.js")),a=u(e("./best-matching-rx.js")),i=u(e("./cache-manager.js")),o=u(e("./go-fetch.js")),s=u(e("./strategies.js")),c=u(e("./utils.js"));function u(e){return e&&e.__esModule?e:{default:e}}var d,l,f,h,p=!1,g=(t.it,[]),v=null,m={version:"#@!THE_DSW_VERSION_INFO!@#",build:"#@!THE_DSW_BUILD_TIMESTAMP!@#",ready:null},S={};function y(){return v||(v=new URL(location.href).pathname.replace(/\/[^\/]+$/,"/"))}m.isOffline=m.offline=function(e){return!navigator.onLine},m.isOnline=m.online=function(e){return navigator.onLine};try{ServiceWorkerGlobalScope;self instanceof ServiceWorkerGlobalScope&&(p=!0)}catch(e){}p?(l={requestId:0,tracking:{},trackMoved:{},rules:{},addRule:function(e,t,n){this.rules[e]=this.rules[e]||[];var r={name:t.name,rx:n,strategy:t.strategy||"offline-first",action:t.apply};return this.rules[e].push(r),r.action.cache?i.default.register(r):!1===r.action.cache&&(r.strategy="online-first"),r},treatBadPage:function(e,t,n){var r=void 0;return l.traceStep(n.request,"Request failed",{status:e.status,statusText:e.statusText,url:e.url,type:e.type}),(l.rules[e&&e.status?e.status:404]||[]).some(function(e,a){var o=t.match(e.rx);if(o&&(e.action.redirect&&!e.action.fetch&&(e.action.fetch=e.action.redirect),e.action.fetch)){l.traceStep(n.request,"Found fallback rule",e,!1,{url:n.request.url,id:n.request.requestId,steps:n.request.traceSteps});var s=new Request(e.action.fetch);return s.requestId=n.request.requestId,s.traceSteps=n.request.traceSteps,r=i.default.get(e,s,n,o),!0}}),r||l.traceStep(n.request,"No fallback found. Request failed"),r||e},setup:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.rootSWScope=y(),c.default.setup(l,PWASettings,m),i.default.setup(l,PWASettings,o.default),s.default.setup(l,i.default,o.default),m.ready=new Promise(function(n,a){d=PWASettings.appShell||[];var o=[];Object.keys(t.rules||t.dswRules).forEach(function(n){var r=n;(n=(t.rules||t.dswRules)[n]).name=r,n.action=n.action||n.apply;var a=n.action,i=void 0,s=void 0,c=void 0;if((n.match.length||Object.keys(n.match).length)&&Object.keys(n.match).length){Array.isArray(n.match)?(i=[],c=[],n.match.map(function(e){e.extension&&i.push(e.extension),e.path&&c.push(e.path)}),(i=i.join("|")).length&&(i+="|"),c=(c.join("|")||"")+"|"):(c=n.match.path||"",i=n.match.extension,s=n.match.status);var u="([/&?]|$)";i=Array.isArray(i)?"([.+]?)("+i.join(u+"|")+u+")":"string"==typeof i?"([.+]?)("+i+u+")":"";var l=new RegExp(c+(i?"((\\.)(("+i+")([\\?&/].+)?))":""),"i"),f=/\$[0-9]+/;(a.fetch&&!a.fetch.match(f)||a.redirect&&!a.redirect.match(f)||a.cache&&a.cache.from)&&d.push({url:a.cache&&a.cache.from?a.cache.from:a.fetch||a.redirect,rule:n}),a.indexedDB=a.indexedDB||a.idb||a.IDB||void 0,a.indexedDB&&o.push(a.indexedDB),(s=Array.isArray(s)?s:[s||"*"]).forEach(function(t){200==t&&(t="*");e.addRule(t,n,l)})}}),e.addRule("*",{name:"serviceWorker",strategy:"fastest",match:{path:/^\/dsw.js(\?=dsw-manager)?$/},apply:{cache:{}}},location.href);if(e.addRule("*",{name:"rootDir",strategy:"fastest",match:{path:y()},apply:{cache:{}}},/^(\/|\/index(\.[0-1a-z]+)?)$/),d.unshift(y()),d.length||o.length)return Promise.all(d.map(function(e){var t=e.url||e;return i.default.add(t,null,null,e.rule).catch(function(e){if(e&&404==e.status)throw g.push(e.url),new Error("Failed storing appshell.\n "+g.join(",")+" failed loading.\n")})}).concat(o.map(function(e){return i.default.createDB(e).catch(function(e){throw new Error("Failed preparing IndexedDB\n",e.message||e)})}))).then(function(e){n()}).catch(function(e){var t="Could not register the service worker.\n"+(e.url||e.message)+"\n";r.default.error(t,e),a(t)});n()})},getRulesBeforeFetching:function(){return this.rules["*"]||!1},createRequest:function(e,t,n){return(0,o.default)(null,e,t,n)},createRedirect:function(e,t,n){return(0,o.default)(null,e,t,n)},traceStep:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Array.isArray(e))e.forEach(function(e){l.traceStep(e,t,n,r,a)});else{if(l.tracking){e.requestId;e.traceSteps=e.traceSteps||[],n=n||{},r&&(n.url=e.url,n.type=e.type,n.method=e.method,n.redirect=e.redirect,n.referrer=e.referrer);var i=(performance.now()-e.timeArriving)/1e3;e.traceSteps.push({step:t,data:n,timing:i.toFixed(4)+"s"})}a&&(l.trackMoved[a.url]=a)}},respondItWith:function(e,t){e.respondWith(new Promise(function(n,r){"function"==typeof t.then?t.then(function(t){if("function"!=typeof t.clone)return n(t);var r=t.clone();l.tracking&&302!=r.status&&r.text().then(function(t){(t[0]||"").charCodeAt(0)<128&&(t=t.substring(0,180)+(t.length>180?"...":"")),l.traceStep(e.request,"Responded",{response:{status:r.status,statusText:r.statusText,type:r.type,method:r.method,url:r.url},preview:t},!0),l.sendTraceData(e)}),n(t)}):n(t)}))},sendTraceData:function(e){var t=void 0,n=function(t,n){var r={id:e.request.requestId,src:e.request.traceSteps[0].data.url,method:e.request.traceSteps[0].data.method,steps:e.request.traceSteps};r.src!=e.request.url&&(r.redirectedTo=e.request.url),t.postMessage(r)};for(t in l.tracking)if(e.request.url.match(t)){l.tracking[t].ports.forEach(n);break}e.request.traceSteps&&e.request.traceSteps.length&&delete l.trackMoved[e.request.traceSteps[0].data.url]},broadcast:function(e){return clients.matchAll().then(function(t){t.forEach(function(t){t.postMessage(e)})})},startListening:function(){self.addEventListener("fetch",function(e){if(l.requestId=1+(l.requestId||0),l.trackMoved[e.request.url]){var t=l.trackMoved[e.request.url];e.request.requestId=t.id,e.request.traceSteps=t.steps,e.request.originalSrc=t.url,t.rule&&t.rule.action&&t.rule.action.cache&&t.rule.action.cache.from&&(e.request.cachedFrom=t.rule.action.cache.from),delete l.trackMoved[e.request.url]}else e.request.requestId=l.requestId,e.request.timeArriving=performance.now(),l.traceStep(e.request,"Arrived in Service Worker",{},!0);var n=new URL(e.request.url),r=n.origin==location.origin,i=n.pathname;if("GET"!=e.request.method)return l.traceStep(e.request,"Ignoring "+e.request.method+" request",{}),void l.sendTraceData(e);if(!Object.keys(l.rules).length)return l.setup(PWASettings).then(function(t){return fetch(e)});if(PWASettings.enforceSSL&&"https:"!=n.protocol&&"localhost"!=n.hostname)return l.traceStep(e.request,"Redirected from http to https"),l.respondItWith(e,Response.redirect(e.request.url.replace("http:","https:"),302));var c=void 0;if(c=r?(0,a.default)(i,l.rules["*"]):(0,a.default)(n.origin+n.pathname,l.rules["*"]))return l.traceStep(e.request,'Best matching rule found: "'+c.rule.name+'"',{rule:c.rule,url:e.request.url}),l.respondItWith(e,s.default[c.rule.strategy](c.rule,e.request,e,c.matching));if(!r)return l.traceStep(e.request,"Ignoring request because it is not from same origin and there are no rules for it",{}),void l.sendTraceData(e);var u=function(t){return!t||200!=t.status&&"opaque"!=t.type&&"opaqueredirect"!=t.type?l.treatBadPage(t,i,e):t};return l.respondItWith(e,fetch((0,o.default)(null,e.request)).then(u).catch(u))})}},f=!1,h=null,self.addEventListener("activate",function(e){var t;e.waitUntil((t=[],PWASettings.applyImmediately&&t.push(self.clients.claim()),t.push(i.default.deleteUnusedCaches(PWASettings.keepUnusedCaches)),Promise.all(t).then(function(e){l.broadcast({DSWStatus:f,error:h||null})}).catch(function(e){l.broadcast({DSWStatus:f,error:e||h})})))}),self.addEventListener("install",function(e){return PWASettings.dswRules=PWASettings.rules||PWASettings.dswRules||{},PWASettings.dswVersion=PWASettings.version||PWASettings.dswVersion||"1",PWASettings.applyImmediately?e.waitUntil(l.setup(PWASettings).then(function(e){f=!0,self.skipWaiting()}).catch(function(e){f=!1,h=e,self.skipWaiting()})):e.waitUntil(l.setup(PWASettings))}),self.addEventListener("message",function(e){var t=e.ports;if(e.data.trackPath){var n=e.data.trackPath;l.tracking[n]={rx:new RegExp(n,"i"),ports:t}}else if(e.data.clearEverythingUp)i.default.clear().then(function(e){t.forEach(function(e){e.postMessage({cacheCleaned:!0})})});else if(e.data.enableMocking){var r=e.data.enableMocking.mockId+e.data.enableMocking.match;S[e.source.id]=S[e.source.id]||{};var a=S[e.source.id];return a[r]=a[r]||[],void S[r].push()}}),self.addEventListener("push",function(e){if(l.broadcast({event:"pushnotification",data:e.data}),PWASettings.notification&&PWASettings.notification.dataSrc)return e.waitUntil(fetch(PWASettings.notification.dataSrc).then(function(e){if(200==e.status)return e.json().then(function(e){var t={};t=PWASettings.notification.dataPath?e[PWASettings.notification.dataPath]:e,self.registration.showNotification(t.title,{body:t.body||t.content||t.message,icon:t.icon||t.image,tag:t.tag||null})});throw new Error("Fetching "+PWASettings.notification.dataSrc+" returned a "+e.status+" status.")}).catch(function(e){r.default.warn("Received a push, but Failed retrieving the notification data.",e)}));if(PWASettings.notification.title){var t=PWASettings.notification;self.registration.showNotification(t.title,{body:t.body||t.content||t.message,icon:t.icon||t.image,tag:t.tag||null})}}),self.addEventListener("notificationclick",function(e){var t=void 0,n={tag:e.notification.tag,title:e.notification.title,body:e.notification.body,icon:e.notification.icon,badge:e.notification.badge,lang:e.notification.lang,timestamp:e.notification.timestamp};e.notification.close(),t=PWASettings.notification&&void 0!==PWASettings.notification.target?PWASettings.notification.target:location.toString(),e.waitUntil(clients.matchAll({type:"window"}).then(function(e){for(var r=void 0,a=0;a<e.length;a++){var i=e[a];if((i.url==t||new URL(i.url).pathname==t)&&"focus"in i){r=i.focus();break}}(r=!r&&t&&clients.openWindow?clients.openWindow(t):Promise.resolve()).then(function(e){l.broadcast({event:"notificationclicked",data:n})})}))}),self.addEventListener("sync",function(e){}),l.startListening()):function(){m.status={version:PWASettings.version||PWASettings.dswVersion,registered:!1,sync:!1,appShell:!1,notification:!1};var e,t=void 0,n=void 0,a=void 0,o=void 0,s=(e={},{addEventListener:function(t,n){e[t]=e[t]||[],e[t].push(n)},trigger:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=void 0;try{if(e[t]){var i=!0,o=!1,s=void 0;try{for(var c,u=e[t][Symbol.iterator]();!(i=(c=u.next()).done);i=!0)"function"==typeof(a=c.value)&&a(n)}catch(e){o=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(o)throw s}}}"function"==typeof m[a="on"+t]&&m[a](n)}catch(e){a=a&&a.name?a.name:a||"annonymous",r.default.error("Failed trigerring event "+t+" on listener "+a,e.message,e)}}});m.addEventListener=s.addEventListener,m.onpushnotification=function(){},m.onnotificationclicked=function(){},m.onenabled=function(){},m.onregistered=function(){},m.onunregistered=function(){},m.onnotificationsenabled=function(){},navigator.serviceWorker.addEventListener("message",function(e){t&&void 0!==e.data.DSWStatus&&(a&&(e.data.DSWStatus?(m.status.appShell=!0,s.trigger("activated",m.status),t(m.status)):(m.status.appShell=!1,m.status.error=e.data.error,n(m.status),a.unregister())),t=!1,n=!1),s.trigger(e.data.event,e.data.data)}),m.trace=function(e,t,n){n||"function"!=typeof t||(n=t,t={});var r=new MessageChannel;r.port1.onmessage=function(e){n(e.data)},navigator.serviceWorker.controller.postMessage({trackPath:e},[r.port2])},m.enableMocking=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".*",n=new MessageChannel;navigator.serviceWorker.controller.postMessage({enableMocking:{mockId:e,match:t}},[n.port2])},m.disableMocking=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".*",n=new MessageChannel;navigator.serviceWorker.controller.postMessage({disableMocking:{mockId:e,match:t}},[n.port2])},m.sendMessage=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(n,r){var a=new MessageChannel;t?a.port1.onmessage=function(e){e.data.error?r(e.data.error):n(e.data)}:setTimeout(n,10),navigator.serviceWorker.controller.postMessage(e,[a.port2])})},m.onNetworkStatusChange=function(e){var t=function(){e(navigator.onLine)};window.addEventListener("online",t),window.addEventListener("offline",t),navigator.onLine||t()},m.isAppShellDone=m.isActivated=function(e){return m.status.registered&&m.status.appShell},m.isRegistered=function(e){return m.status.registered},m.enableNotifications=function(e){return new Promise(function(e,t){navigator.onLine?navigator.serviceWorker.ready.then(function(n){return n.pushManager.subscribe({userVisibleOnly:!0}).then(function(t){m.status.notification=t.endpoint,s.trigger("notificationsenabled",m.status),r.default.info("Registered to notification server"),e(t)}).catch(function(e){t(e||"Not allowed by user")})}):t("Must be connected to enable notifications")})},m.notify=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Untitled",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,r){m.enableNotifications().then(function(r){var a={body:t.body||"",icon:t.icon||!1,tag:t.tag||null},i=new Notification(e,a);t.duration&&setTimeout(function(e){i.close()},1e3*t.duration),n(i)}).catch(function(e){r(e)})})},m.unregister=function(e){return new Promise(function(e,t){m.status&&(m.status.registered||e(m.status)),m.ready.then(function(n){i.default.clear().then(function(n){n?(m.status.appShell=!1,localStorage.setItem("DSW-STATUS",JSON.stringify(m.status)),a.unregister().then(function(n){n?(m.status.registered=!1,m.status.sync=!1,m.status.notification=!1,m.status.ready=!1,localStorage.setItem("DSW-STATUS",JSON.stringify(m.status)),e(m.status),s.trigger("unregistered",m.status)):t("Could not unregister service worker")})):t("Could not clean up the caches")})})})},m.setup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m.ready?m.ready:new Promise(function(i,c){if(m.ready=new Promise(function(i,c){var u=new Promise(function(e,n){t=function(){clearTimeout(o),e(m.status)}});if(n=function(e){clearTimeout(o),c(e||"Installation timeout")},navigator.serviceWorker)if(navigator.serviceWorker.controller)e&&e.trace?navigator.serviceWorker.ready.then(function(t){a=t;var n=void 0;for(n in e.trace)m.trace(n,e.trace[n])}):navigator.serviceWorker.ready.then(function(e){a=e}),m.status=JSON.parse(localStorage.getItem("DSW-STATUS"))||m.status,i(m.status);else{o=setTimeout(function(e){c("Registration timed out")},e.timeout||12e3);var d=new Promise(function(e){"complete"===document.readyState?e(document):document.addEventListener("DOMContentLoaded",function(){e(document)})}),l=document.querySelector('script[src$="dsw.js"]').getAttribute("src");Promise.all([d,navigator.serviceWorker.register(l)]).then(function(t){a=t,m.status.registered=!0,navigator.serviceWorker.ready.then(function(t){m.status.ready=!0,s.trigger("registered",m.status),Promise.all([u,new Promise(function(e,t){if(PWASettings.notification&&PWASettings.notification.auto)return m.enableNotifications();e()}),new Promise(function(t,n){e&&e.sync?"SyncManager"in window?navigator.serviceWorker.ready.then(function(e){return e.sync.register("syncr")}).then(function(e){m.status.sync=!0,t()}):(m.status.sync="Failed enabling sync",t()):t()})]).then(function(e){localStorage.setItem("DSW-STATUS",JSON.stringify(m.status)),s.trigger("enabled",m.status),r.default.info("Service Worker was registered",m.status),i(m.status)})})}).catch(function(e){c({status:!1,sync:!1,sw:!1,message:"Failed registering service worker with the message:\n "+e.message,error:e})})}else m.status.fail="Service worker not supported"}),!m.isActivated())return m.ready.then(function(e){i(e)}).catch(function(e){c(e)})})},"undefined"!=typeof window&&(window.DSW=m)}(),n.default=m}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./best-matching-rx.js":1,"./cache-manager.js":2,"./go-fetch.js":3,"./logger.js":5,"./strategies.js":7,"./utils.js":8}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,a=e("./utils.js"),i=(r=a)&&r.__esModule?r:{default:r};var o=void 0,s=void 0,c=void 0;function u(e,t,n,r){e.action.bundle&&(o.traceStep(n.request,"Will load and cache bundle in background",{bundle:e.action.bundle}),s.addAll(e.action.bundle).then(function(t){o.traceStep(n.request,"Bundle loaded and cached in background",{bundle:e.action.bundle})}).catch(function(t){o.traceStep(n.request,"Could not load and cache bundle",{bundle:e.action.bundle}),console.warn("Could not load and cache all the bundle files",t.message||t)}))}var d={setup:function(e,t,n){o=e,s=t,c=n},"offline-first":function(e,t,n,r){return u(e,0,n),o.traceStep(n.request,"Info: Using offline first strategy",{url:t.url}),s.get(e,t,n,r)},"online-first":function(e,t,n,r){function a(a){return 200==a.status?(e.action.cache&&s.put(e,t,a).then(function(e){o.traceStep(n.request,"Updated cache")}),a):s.get(e,t,n,r).then(function(e){var t=new URL(n.request.url).pathname;return e||o.treatBadPage(a,t,n)})}return u(e,0,n),o.traceStep(n.request,"Info: Using online first strategy",{url:t.url}),i.default.DSW.isOffline()?a(new Response("",{status:404,statusText:"Browser is offline",headers:{"Content-Type":"text/plain"}})):c(e,t,n,r).then(a).catch(a)},fastest:function(e,t,n,r){u(e,0,n),o.traceStep(n.request,"Info: Using fastest strategy",{url:t.url});var a=new URL(n.request.url).pathname,i=!1,d=!1,l=!1,f=!1;return new Promise(function(u,h){function p(r){r&&200==r.status&&e.action.cache&&s.put(e,t,r).then(function(e){o.traceStep(n.request,"Updated cache")}),d||(200==r.status?(i=!0,o.traceStep(n.request,"Fastest strategy resolved from network",{url:r.url||t.url}),u(r)):(o.traceStep(n.request,"Fastest strategy failed fetching",{status:r.status,statusText:r.statusText}),l=!0,g(r)))}function g(e){l&&f&&(o.traceStep(n.request,"Fastest strategy could not fetch nor find in cache"),u(o.treatBadPage(e,a,n)))}c(e,t.clone(),n,r).then(p).catch(p),s.get(e,t,n,r,!1,!1).then(function(e){if(e&&!i)return d=!0,o.traceStep(n.request,"Fastest strategy resolved from cached"),u(e),e;f=!0,i||g()}).catch(g)})}};n.default=d},{"./utils.js":8}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r={DSWManager:null,PWASettings:null,applyMatch:function(e,t){return e&&e.length>1&&t&&e.forEach(function(e,n){t=t.replace(new RegExp("\\$"+n,"i"),e)}),t},createRequest:function(e,t){var n={method:t.method||e.method||"GET",headers:t.headers||e.headers||new Headers,mode:t.mode||(t.redirect?"same-origin":"cors"),redirect:t.redirect||"manual",cache:"default"},r=new Request(e.url||e,n);return r.requestId=e.requestId,r},fixURL:function(e){return r.DSWManager.rootSWScope!=e?e.replace(/^([^http]|[^\/]|[^\.])/,r.DSWManager.rootSWScope+"/$1").replace(/([^\:])\/\//g,"$1"):e},setup:function(e,t,n){r.DSWManager=e,r.PWASettings=t,r.DSW=n}};n.default=r},{}]},{},[6]);